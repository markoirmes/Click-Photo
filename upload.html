<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content />
    <meta name="author" content />
    <title>Click Photo | Online izrada fotografija</title>
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <script data-search-pseudo-elements defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/js/all.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.24.1/feather.min.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Varela+Round&display=swap&subset=latin-ext" rel="stylesheet" />
    <link href="assets/css/styles.css" rel="stylesheet" />
    <link href="assets/css/nice-select.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png" />
    <style>
      select {
        display: none;
      }
    </style>
    >
  </head>
  <body>
    <div id="layoutDefault">
      <div id="layoutDefault_content">
        <main>
          <nav id="navigation" class="navbar navbar-marketing navbar-expand-lg bg-dark navbar-dark fixed-top">
            <div class="container">
              <a class="navbar-brand text-white" href="index.html"><img id="logo" src="assets/img/logo.png" width="110"/></a
              ><button
                class="navbar-toggler"
                type="button"
                data-toggle="collapse"
                data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <i data-feather="menu"></i>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto mr-lg-5">
                  <li class="nav-item"><a class="nav-link" href="index.html">Početna</a></li>
                  <li class="nav-item"><a class="nav-link" href="javascript:void(0);">O nama</a></li>
                  <li class="nav-item"><a class="nav-link" href="cenovnik.html">Cenovnik</a></li>
                  <li class="nav-item dropdown no-caret">
                    <a
                      class="nav-link dropdown-toggle"
                      id="navbarDropdownDocs"
                      href="javascript:void(0);"
                      role="button"
                      data-toggle="dropdown"
                      aria-haspopup="true"
                      aria-expanded="false"
                      >Informacije<i class="fas fa-chevron-right dropdown-arrow"></i
                    ></a>
                    <div class="dropdown-menu dropdown-menu-right animated--fade-in-up" aria-labelledby="navbarDropdownDocs">
                      <a class="dropdown-item py-3" href="najcesca-pitanja.html"
                        ><div class="icon-stack bg-gradient-primary-to-secondary text-white mr-4"><i class="fas fa-question"></i></div>
                        <div>
                          <div class="small text-gray-500">Sve o korišćenju naših usluga</div>
                          Najčešća pitanja
                        </div></a
                      >
                      <div class="dropdown-divider m-0"></div>
                      <a class="dropdown-item py-3" href="politika-privatnosti.html"
                        ><div class="icon-stack bg-gradient-primary-to-secondary text-white mr-4"><i class="fas fa-lock"></i></div>
                        <div>
                          <div class="small text-gray-500">Privatnost</div>
                          Politika privatnosti
                        </div></a
                      >
                      <div class="dropdown-divider m-0"></div>
                      <a class="dropdown-item py-3" href="uslovi-koriscenja.html"
                        ><div class="icon-stack bg-gradient-primary-to-secondary text-white mr-4"><i class="fas fa-file-alt"></i></div>
                        <div>
                          <div class="small text-gray-500">Sve o korišćenju sajta i usluga</div>
                          Uslovi korišćenja
                        </div></a
                      >
                    </div>
                  </li>
                  <li class="nav-item"><a class="nav-link" href="kontakt.html">Kontakt</a></li>
                </ul>
              </div>
            </div>
          </nav>

          <header class="page-header page-header-dark bg-dark">
            <div class="page-header-content pt-10">
              <div class="container text-center">
                <div class="row justify-content-center">
                  <div class="col-lg-8">
                    <h1 class="page-header-title mb-3">Pošalji fotografije</h1>
                    <p class="page-header-text">I stižu Vam u roku od par dana na kućnu adresu.</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="container">
              <div class="row justify-content-center text-center">
                <div class="col-12">
                  <select id="dimenzija">
                    <option value="9x13">9x13</option>
                    <option value="10x15">10x15</option>
                    <option value="13x18">13x18</option>
                    <option value="15x21">15x21</option>
                    <option value="20x30">20x30</option>
                    <option value="25x38">25x38</option>
                  </select>
                  <select id="papir"
                    ><option value="Mat" selected>Mat</option>
                    <option value="Sjajan">Sjajan</option>
                  </select>
                  <input id="kolicina" type="number" min="1" max="500" class="qty Field qtyFieldMain" value="1" />
                  <input class="hidden" type="file" id="files" name="files" multiple />
                  <button id="dodaj" class="btn btn-teal btn-marketing rounded-pill lift lift-sm">Dodaj<i class="fas fa-file-upload ml-1"></i></button
                  ><button id="obrisiSve" disabled class="btn btn-teal btn-marketing rounded-pill lift lift-sm confirm">
                    Obriši sve<i class="fas fa-trash-alt ml-1"></i>
                  </button>
                </div>
              </div>
            </div>
            <div class="svg-border-rounded text-light">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144.54 17.34" preserveAspectRatio="none" fill="currentColor">
                <path d="M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"></path>
              </svg>
            </div>
          </header>
          <section class="bg-light py-10">
            <div class="container">
              <div class="row">
                <div class="col-12">
                  <div class="row justify-content-center" id="thumbnails"></div>
                </div>
              </div>
            </div>

            <div class="container cenovnik hidden" id="cenovnik">
              <div class="row">
                <div class="col-lg-3"></div>
                <div class="col-lg-6">
                  <div class="container cp-10">
                    <div class="row"><div class="col-12">Fotografije</div></div>
                    <div class="row">
                      <div class="col-6 text-left">Dodatih</div>
                      <div class="col-6 text-right" id="dodatih">-</div>
                    </div>
                    <div class="row">
                      <div class="col-6 text-left">Za izradu</div>
                      <div class="col-6 text-right" id="zaIzradu">-</div>
                    </div>
                  </div>
                  <div class="container cp-10">
                    <div class="row">
                      <div class="col-12">Vaša korpa</div>
                    </div>
                    <div class="row">
                      <div class="col-6 text-left">Cena</div>
                      <div class="col-6 text-right" id="cena">-</div>

                      <div class="col-6 text-left">Dostava</div>
                      <div class="col-6 text-right" id="dostava">-</div>
                    </div>
                    <div class="row">
                      <div class="col-6 text-left">UKUPNO</div>
                      <div class="col-6 text-right" id="ukupno">-</div>
                    </div>
                  </div>

                  <div class="container cp-10">
                    <div class="row">
                      <div class="col-12">
                        <button id="kupovina" class="btn btn-teal btn-marketing rounded-pill lift lift-sm" disabled>NARUCI</button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-3"></div>
              </div>
            </div>

            <div class="svg-border-rounded text-dark">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144.54 17.34" preserveAspectRatio="none" fill="currentColor">
                <path d="M144.54,17.34H0V0H144.54ZM0,0S32.36,17.34,72.27,17.34,144.54,0,144.54,0"></path>
              </svg>
            </div>
          </section>
        </main>
      </div>
      <div id="layoutDefault_footer">
        <footer class="footer pt-10 pb-5 mt-auto bg-dark footer-dark mobile-text-center">
          <div class="container footer-container">
            <div class="row ">
              <div class="col-lg-3">
                <div class="footer-brand">Click Photo</div>
                <div class="mb-3">Online izrada fotografija</div>
                <div class="icon-list-social mb-5 mobile-socialicons-center">
                  <a class="icon-list-social-link" href="javascript:void(0);"><i class="fab fa-instagram"></i></a
                  ><a class="icon-list-social-link" href="javascript:void(0);"><i class="fab fa-facebook"></i></a>
                </div>
              </div>
              <div class="col-lg-9">
                <div class="row ">
                  <div class="col-lg-3 col-md-6 mb-5 mb-lg-0">
                    <div class="text-uppercase-expanded text-xs mb-4">O fotografijama</div>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-2"><a href="javascript:void(0);">Veličina papira</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Vrsta papira</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Odnos dimenzija</a></li>
                    </ul>
                  </div>
                  <div class="col-lg-3 col-md-6 mb-5 mb-lg-0">
                    <div class="text-uppercase-expanded text-xs mb-4">O nama</div>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-2"><a href="javascript:void(0);">O foto studiju</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Upoznajte tim</a></li>
                    </ul>
                  </div>
                  <div class="col-lg-3 col-md-6 mb-5 mb-md-0">
                    <div class="text-uppercase-expanded text-xs mb-4">Informacije</div>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-2"><a href="javascript:void(0);">Cenovnik</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Kako poručiti</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Najčešća pitanja</a></li>
                    </ul>
                  </div>
                  <div class="col-lg-3 col-md-6">
                    <div class="text-uppercase-expanded text-xs mb-4">Pravne stvari</div>
                    <ul class="list-unstyled mb-0">
                      <li class="mb-2"><a href="javascript:void(0);">Politika privatnosti</a></li>
                      <li class="mb-2"><a href="javascript:void(0);">Uslovi korišćenja</a></li>
                      <li><a href="javascript:void(0);">Dostava</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <hr class="my-5" />
            <div class="row  align-items-center">
              <div class="col-md-6 small">Copyright 2020 &#xA9; Click Photo. Sva prava zadržana.</div>
              <div class="col-md-6 text-md-right small">
                <a href="politika-privatnosti.html">Politika privatnosti</a>
                &#xB7;
                <a href="uslovi-koriscenja.html">Uslovi korišćenja</a>
              </div>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="assets/js/scripts.js"></script>
    <script src="assets/js/navcolor.js"></script>
    <script src="assets/js/nice-select.js"></script>
    <script src="assets/js/confirm.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script>
      AOS.init({
        disable: "mobile",
        duration: 600,
        once: true
      });
    </script>

    <script>
      function poruci() {
        const data = Array.prototype.slice.call(document.getElementsByClassName("thumbs")).map(function(thumb) {
          return {
            user: "",
            size: "",
            paper: "",
            copies: 1,
            name: "",
            file: ""
          };
        });
        console.log(data);
      }

      function checkQuality() {
        const progress = document.getElementsByClassName("thumbs");
        let dpi = 0;
        const danger = 0.6;
        const size = [1000, 1200, 1500, 1800, 2400, 3000];

        for (let i = 0; i < progress.length; i++) {
          const width = progress[i].querySelector(".upload-image").naturalWidth;
          const height = progress[i].querySelector(".upload-image").naturalHeight;
          const progressLine = progress[i].querySelector(".progress-bar");
          const dimension = progress[i].querySelector("select.sizeSelect").value;
          if (dimension == "9x13") {
            if (width < size[0] * danger || height < size[0] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[0] || height < size[0]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          } else if (dimension == "10x15") {
            if (width < size[1] * danger || height < size[1] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[1] || height < size[1]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          } else if (dimension == "13x18") {
            if (width < size[2] * danger || height < size[2] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[2] || height < size[2]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          } else if (dimension == "15x21") {
            if (width < size[3] * danger || height < size[3] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[3] || height < size[3]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          } else if (dimension == "20x30") {
            if (width < size[4] * danger || height < size[4] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[4] || height < size[4]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          } else if (dimension == "25x38") {
            if (width < size[5] * danger || height < size[5] * danger) {
              progressLine.className = "progress-bar bg-danger";
              progressLine.style = "width:50%;";
            } else if (width < size[5] || height < size[5]) {
              progressLine.className = "progress-bar bg-warning";
              progressLine.style = "width:75%;";
            } else {
              progressLine.className = "progress-bar bg-success";
              progressLine.style = "width:100%;";
            }
          }
        }
      }

      // kalkulacija

      function cenaPoDimenziji(size) {
        switch (size) {
          case "9x13":
            return 10;
          case "10x15":
            return 15;
          case "13x18":
            return 20;
          case "15x21":
            return 25;
          case "20x30":
            return 30;
          case "25x38":
            return 35;
        }
      }

      function kalkulacija() {
        let cena = 0;
        let izrada = 0;
        let dostava = 300;

        const thumbs = Array.prototype.slice.call(document.getElementsByClassName("thumbs"));
        for (let i = 0; i < thumbs.length; i++) {
          cena += cenaPoDimenziji(thumbs[i].querySelector("select.sizeSelect").value) * thumbs[i].querySelector("input").value;
          izrada += 1 * thumbs[i].querySelector("input").value;
        }

        if (cena >= 1000) {
          dostava = 0;
        } else if (cena == 0) {
          dostava = 0;
        } else {
          dostava = 300;
        }

        const ukupno = cena + dostava;

        document.getElementById("cena").innerHTML = cena;
        document.getElementById("dodatih").innerHTML = thumbs.length;
        document.getElementById("dostava").innerHTML = dostava;
        document.getElementById("zaIzradu").innerHTML = izrada;
        document.getElementById("ukupno").innerHTML = ukupno;
      }

      // CREATE EVENT LISTENER FOR DIV CHANGES - RUNS EVERY TIME IMAGE CONTAINER DOM CHANGES
      const target = document.querySelector("#thumbnails");
      // create an observer instance
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (document.getElementById("thumbnails").hasChildNodes()) {
            // Enable delete all button and purchase button
            document.getElementById("obrisiSve").disabled = false;
            document.getElementById("kupovina").disabled = false;

            // Show pricing
            const cenovnik = document.getElementById("cenovnik");
            cenovnik.classList.remove("hidden");

            // CHECK ASPECT RATIO AND ADJUST ORIENTATION
            const nizSlika = document.getElementsByClassName("upload-image");
            for (let i = 0; i < nizSlika.length; i++) {
              if (nizSlika[i].naturalWidth > nizSlika[i].naturalHeight) {
                nizSlika[i].parentElement.classList.add("landscape");
              }
            }

            // DELETE BUTTON FUNCTION
            const deleteButtonList = document.getElementsByClassName("deleteImg");
            for (let i = 0; i < deleteButtonList.length; i++) {
              deleteButtonList[i].addEventListener(
                "click",
                function(e) {
                  e.currentTarget.parentNode.parentNode.parentNode.remove();
                },
                false
              );
            }
          } else {
            // Disable delete all button
            document.getElementById("obrisiSve").disabled = true;
            document.getElementById("kupovina").disabled = true;
            const cenovnik = document.getElementById("cenovnik");
            cenovnik.classList.add("hidden");
          }

          // Calculate
          kalkulacija();

          //CHECK QUALITY
          checkQuality();
        });
      });

      // configuration of the observer:
      const config = { attributes: true, childList: true, characterData: true };

      // pass in the target node, as well as the observer options
      observer.observe(target, config);

      // NICE SELECT OPTIONS STYLING
      $(document).ready(function() {
        $("select").niceSelect();
      });

      //  ADD CLICK TO UPLOAD
      $("#dodaj").on("click", function() {
        $("#files").trigger("click");
      });

      // CONFIRM DELETE DIALOG POPUP

      $(".confirm").confirm({
        text: "Da li sigurno želite da obrišete slike?",
        title: "",
        confirm: function(button) {
          $("#thumbnails").html("");
        },
        cancel: function(button) {
          // nothing to do
        },
        confirmButton: "Da",
        cancelButton: "Ne",
        post: true,
        confirmButtonClass: "btn btn-teal btn-marketing rounded-pill",
        cancelButtonClass: "btn btn-teal btn-marketing rounded-pill btn-outline",
        dialogClass: "modal-dialog"
      });

      // IMAGE UPLOAD PREVIEW

      function previewImages() {
        const preview = document.querySelector("#thumbnails");

        if (this.files) {
          [].forEach.call(this.files, readAndPreview);
        }

        document.querySelector("#files").value = null;

        function readAndPreview(file) {
          // Check file name and file size
          if (!/\.(jpeg|jpg|png)$/i.test(file.name)) {
            return alert(file.name + " nije odgovarajuci fajl.");
          } else if (file.size > 5242880) {
            return alert("Slika " + file.name + " je veća od 5MB!");
          } else if (file.naturalHeight < 1000 || file.naturalWidth < 1000) {
            return alert("Minimalna dimenzija slike je 1000x1000");
          }

          const reader = new FileReader();

          reader.addEventListener(
            "load",
            function() {
              // GENERATE IMAGE ELEMENT
              const mainDiv = document.createElement("div");
              mainDiv.setAttribute("class", "col-lg-4 col-md-6 thumbs");
              const imgDiv = document.createElement("div");
              imgDiv.setAttribute("class", "img-div");
              const imgDetails = document.createElement("div");
              imgDetails.setAttribute("class", "imgDetails");
              const imgSelect = document.createElement("div");
              imgSelect.setAttribute("class", "imgSelect");
              const deleteButton = document.createElement("button");
              deleteButton.setAttribute("class", "deleteImg");
              deleteButton.innerHTML = '<i class="fas fa-trash"></i>';
              const imageName = document.createElement("p");
              imageName.setAttribute("class", "imgName");
              imageName.textContent = file.name;

              // select dimension
              const selectFieldSize = document.createElement("select");
              selectFieldSize.setAttribute("class", "sizeSelect");
              selectFieldSize.addEventListener("change", kalkulacija);
              selectFieldSize.addEventListener("change", checkQuality);
              const size1 = document.createElement("option");
              size1.text = "9x13";
              size1.value = "9x13";
              selectFieldSize.add(size1);
              const size2 = document.createElement("option");
              size2.text = "10x15";
              size2.value = "10x15";
              selectFieldSize.add(size2);
              const size3 = document.createElement("option");
              size3.text = "13x18";
              size3.value = "13x18";
              selectFieldSize.add(size3);
              const size4 = document.createElement("option");
              size4.text = "15x21";
              size4.value = "15x21";
              selectFieldSize.add(size4);
              const size5 = document.createElement("option");
              size5.text = "20x30";
              size5.value = "20x30";
              selectFieldSize.add(size5);
              const size6 = document.createElement("option");
              size6.text = "25x38";
              size6.value = "25x38";
              selectFieldSize.add(size6);
              selectFieldSize.value = document.getElementById("dimenzija").options[document.getElementById("dimenzija").selectedIndex].value;

              // select paper
              const selectFieldPaper = document.createElement("select");
              selectFieldPaper.setAttribute("class", "paperSelect");
              const paper1 = document.createElement("option");
              paper1.text = "Mat";
              paper1.value = "Mat";
              selectFieldPaper.add(paper1);
              const paper2 = document.createElement("option");
              paper2.text = "Sjajan";
              paper2.value = "Sjajan";
              selectFieldPaper.add(paper2);
              selectFieldPaper.value = document.getElementById("papir").options[document.getElementById("papir").selectedIndex].value;

              const qtyInput = document.createElement("input");
              qtyInput.setAttribute("type", "number");
              qtyInput.setAttribute("class", "qtyField");
              qtyInput.setAttribute("min", "1");
              qtyInput.setAttribute("max", "500");
              qtyInput.addEventListener("change", kalkulacija);
              qtyInput.value = document.getElementById("kolicina").value;
              const progressBarContainer = document.createElement("div");
              progressBarContainer.setAttribute("class", "progress");
              const progressBar = document.createElement("div");
              progressBar.setAttribute("class", "progress-bar");
              progressBarContainer.appendChild(progressBar);
              const image = new Image();
              image.setAttribute("class", "upload-image");
              image.title = file.name;
              image.src = this.result;
              preview.appendChild(mainDiv);
              mainDiv.appendChild(imgDiv);
              mainDiv.appendChild(imgDetails);
              imgDiv.append(image);
              imgDetails.appendChild(imageName);
              imgDetails.appendChild(imgSelect);
              imgSelect.appendChild(selectFieldSize);
              imgSelect.appendChild(selectFieldPaper);
              imgSelect.appendChild(qtyInput);
              imgSelect.appendChild(deleteButton);
              imgDetails.appendChild(progressBarContainer);
              $("select").niceSelect();

              Array.prototype.slice.call(mainDiv.querySelectorAll(".nice-select li.option")).forEach(function(li) {
                li.addEventListener("click", function() {
                  setTimeout(kalkulacija, 0);
                  setTimeout(checkQuality, 0);
                });
              });
              checkQuality();
              kalkulacija();
            },
            false
          );

          reader.readAsDataURL(file);
        }
      }

      document.querySelector("#files").addEventListener("change", previewImages, false);
    </script>
  </body>
</html>
